<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js'></script>
    <title>Upoznaj svog poslanika</title>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8iROkLemDoQ0DtokakfnPecU0h0rOK9I&callback=initMap">
    </script>
    
    <style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
    
    #map {
        height: 100%;
    }
    /* Optional: Makes the sample page fill the window. */
    
    html,
    body {
        height: 100%;
        margin: 0;
        padding: 0;
    }
    
    .videoPoslanika {
        max-width: 100px;
    }
    </style>
</head>

<body>
    <div id="myModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Modal title</h4>
                </div>
                <div class="modal-body">
                	<div class="videos"></div>
                	<div class="rss"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
    <div id="slickeTest">
    </div>
    <div id="map"></div>
    <script>
    var sirina;
    var duzina;

    $.getJSON('poslanici.json', function(json, textStatus) {

        sirina = 44.32;
        duzina = 20;

    });


    //lokacije mesta rodjenja


    function parseRSS(podaci) {
    	$(".rss").empty();

    	for (var i = 0; i < podaci.length; i++) {
    		var tempInput = podaci[i];
    		$(".rss").append('<a href="'+tempInput.link+'">'+tempInput.title+'</a> <br/>'+tempInput.pubDate+' <br/>')
    	}
    }


    function getRSS1(argument) {

        var FEED_URL = "http://www.naslovi.net/rss/search.php?q=nenad+canak";

        var link =  "http://api.rss2json.com/v1/api.json?rss_url="+FEED_URL +"&callback=parseRSS";

        $.ajax({
		    url: link,
		 
		    // The name of the callback parameter, as specified by the YQL service
		    jsonp: "callback",
		 
		    // Tell jQuery we're expecting JSONP
		    dataType: "jsonp",		 
		    
		 
		    // Work with the response
		    success: function( response ) {

		    	if(response.status == "ok")
		        	parseRSS( response.items ); // server response
		    }
		});

       
    }


    function listaYTvidea(argument) {
        $.getJSON('https://www.googleapis.com/youtube/v3/search?part=snippet&q=' + "nenad canak" + '&maxResults=15&order=date&key=AIzaSyC4AE6JNj2vQx_-XpLWHtV4-v5uQR-fM1Q', function(json, textStatus) {

            var videos = json.items;

            console.log(videos);
            $(".videos").empty();

            for (var i = 0; i < videos.length; i++) {

                var videoInfo = videos[i].snippet;
                var videoId = videos[i].id.videoId;

                $(".videos").append(' <a target="_blank" href="https://www.youtube.com/watch?v=' + videoId + '"><img class="videoPoslanika" src="' + videoInfo.thumbnails.high.url + '" alt="' + videoInfo.title + '" /> </a>')

            }

        });
    }


    var map;

    function initMap() {
        var myLatLng = {
            lat: 44.363,
            lng: 20.044
        };

        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 9,
            center: myLatLng
        });

        initHandler();

        listaYTvidea();
        getRSS1();

    }

    function initHandler(argument) {

        google.maps.event.addListenerOnce(map, 'idle', function() {
            for (var i = 0; i < 100; i++) {

                var pomX = Math.random();
                var pomY = Math.random();


                var marker = new google.maps.Marker({
                    position: {
                        lat: sirina + pomX,
                        lng: duzina + pomY
                    },
                    map: map,
                    title: 'Hello World!',
                    details: {
                        opis: "bilo koji podatak * " + i,
                        poruka: "vidimo se" + i
                    }
                });




                marker.addListener('click', function() {
					

					
                    $('#myModal').modal('show')


                    /*alert("napraviti modal koji ce da prikazuje podatke za marker " + this.details.opis + "  _ " + this.details.poruka)*/
                });

            }


        }); //idle handler



    } //initHandler
    </script>
</body>

</html>
